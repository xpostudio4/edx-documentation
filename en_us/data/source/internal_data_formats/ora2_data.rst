.. _ORA2 Data:

##############################
Open Response Assessment Data
##############################

This section describes the data schema for the edX open response assessment
(ORA) peer assessment system.

.. contents::
  :local:
  :depth: 1

The schema includes a number of tables, and the ORA system offers a range of
uses. As a result, the data can be complex. EdX recommends that you set up a
course on a devstack so that you can set up assessments and test various
possible learner interactions with them.

* For more information about how course teams can set up open response
  assessments, see :ref:`partnercoursestaff:PA Create an ORA Assignment`.

* For more information about how learners respond to these assessments, see
  :ref:`learners:SFD_ORA`.

* For more information about setting up a devstack Vagrant instance, see
  :ref:`installation:Installing the Open edX Developer Stack`.

**********
Overview
**********

The SQL tables that store data for ORA assessments can be grouped into the
following ***categories.

.. better way to describe these?

===================
Workflow Tables
===================

The ORA workflow tables store data about a response that a learner submits as
it goes through each of the series of steps defined for the ORA component.

The top-level table is ``AssessmentWorkflow``, which specifies the steps that a
learner must complete for the ORA component. A self-assessment step is
required, but a component can also include a training step, a peer evaluation
step, or both.

 .. image:: ../Images/ora2-tables-erd_AssessmentWorkflow.png
  :alt: Diagram of the assessment workflow and assessment workflow step tables.

Additional tables store data for these optional steps.

* ``StudentTrainingWorkflow`` stores data about a learner's evaluation of a set
  of instructor-provided samples, including what has been completed and when
  each evaluation was made.

* ``PeerWorkflow`` stores data about the progress of a response as it undergoes
  peer grading, which can involve input from one or more peers.

A separate table is not provided for self assessment responses. The self
assessment step in an ORA component is a required, single-step process.

.. where is the self assessment stored? AssessmentWorkflowStep (which is a separate table...)

======================================
Assessment and Rubric Tables
======================================

The assessment tables store an assessment made for a particular response. An
assessment can be a self assessment, submitted by the learner about her own
work, or a peer assessment, which is submitted by another learner. Assessments
are scored against rubrics.

A ``Rubric`` specifies guidelines on how to assess submissions. Each rubric
consists of a set of ``Criterion`` entries, each of which has a set of
``CriterionOptions``.

For example, a criterion for assessing writing might be "The essay is well
structured". The options for that criterion might be, "no evidence of
structure--totally rambling", "there is an attempt at organizing the material,
but it doesn't flow very well", and "clear structure, structure from beginning
to end".

Rubrics are immutable, and are written to the table at the time of assessment.
If a rubric for a problem changes, these tables contain different entries for
assessments that were done before, and after, the change.

=========================================
Submission, StudentItem, and Score Tables
=========================================

The ``Submission`` table represents the responses made by a learner for a given
problem in a given course. Depending on the configuration of the ORA component,
a learner can contribute multiple submissions for a given problem. Submissions
can also be generated by the system, for example, to correct a software error.

The ``StudentItem`` table identifies a particular learner and a particular
item in a course. Rows in this table are linked to all submissions made by that
learner for that item, as well as to each ``Score`` for that item.

 .. image:: ../Images/ora2-tables-erd_SubmissionStudentItemScore.png
  :alt: Diagram of the tables used for tracking submissions, student items,
      scores, and the related score summary table.

*************
Detailed ERD
*************

This entity relationship diagram (ERD) provides a reference for the
tables involved, their columns, and their relationships.

Note that some of the models have a many-to-many relationship, in which case
there is a table corresponding to the edge between them. An example is
``assessment_trainingexample_options_selected``.

.. I don't understand this note or example ^^

 .. image:: ../Images/ora2-tables-erd.png
  :alt: Diagram of the primary tables used for ORA2--tracking submissions, assessments, rubrics, etc.

To ensure that the diagram can be viewed at full size, this ERD is also available on the edX wiki, ***xref TBD.


*********
Notes
*********

* Anonymous learner IDs are used throughout the ORA2 data. To link to full user
  data, you must join to the ``student_anonymoususerid`` table.

* The schema diagram includes several tables with "AI" in the name. They are
  used for our prototype example-based ("AI") assessment system. It is not yet
  ready for general use, so those tables aren't included in edX data packages.

.. ^ still true?
